<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Reshapes community data from individual into stratified form — stratifyvegdata • vegclust</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Reshapes community data from individual into stratified form — stratifyvegdata"><meta property="og:description" content="Function stratifyvegdata reshapes individual abundance values into species abundance values per size class or combination of size classes. Function as.stratifiedvegdata checks if the input list has appropriate properties and turns it into an object of class 'stratifiedvegdata'."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vegclust</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/MedRegExample.html">Describing vegetation in terms of structure and composition</a>
    </li>
    <li>
      <a href="../articles/VegetationClassification.html">How to use the vegclust package</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Reshapes community data from individual into stratified form</h1>
    
    <div class="hidden name"><code>stratifyvegdata.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function <code>stratifyvegdata</code> reshapes individual abundance values into species abundance values per size class or combination of size classes. Function <code>as.stratifiedvegdata</code> checks if the input list has appropriate properties and turns it into an object of class '<code>stratifiedvegdata</code>'.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">stratifyvegdata</span><span class="op">(</span><span class="va">x</span>, <span class="va">sizes1</span>, sizes2 <span class="op">=</span> <span class="cn">NULL</span>, treeSel<span class="op">=</span><span class="cn">NULL</span>, spcodes <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                plotColumn<span class="op">=</span><span class="st">"plot"</span>, speciesColumn <span class="op">=</span> <span class="st">"species"</span>, </span>
<span>                abundanceColumn<span class="op">=</span><span class="st">"abundance"</span>, size1Column <span class="op">=</span> <span class="st">"size"</span>, size2Column <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                cumulative<span class="op">=</span><span class="cn">FALSE</span>, counts<span class="op">=</span><span class="cn">FALSE</span>, mergeSpecies<span class="op">=</span><span class="cn">FALSE</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">as.stratifiedvegdata</span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>A data frame containing individual plant data. Individuals are in rows, while measurements are in columns.</p></dd>

  <dt>sizes1</dt>
<dd><p>A numerical vector containing the breaks for primary size classes in ascending order.</p></dd>

  <dt>sizes2</dt>
<dd><p>A numerical vector containing the breaks for secondary size classes in ascending order.</p></dd>

  <dt>treeSel</dt>
<dd><p>A logical vector specifying which rows in <code>x</code> to be used. By default (<code>treeSel = NULL</code>) all rows are taken.</p></dd>

  <dt>spcodes</dt>
<dd><p>A character vector indicating the codes of species to be used for stratification (species codes beyond those appearing in <code>x</code> are possible). If <code>spcodes = NULL</code> then all species in <code>x</code> are used.</p></dd>

  <dt>plotColumn</dt>
<dd><p>The name of the column in <code>x</code> that contains plot identifiers.</p></dd>

  <dt>speciesColumn</dt>
<dd><p>The name of the column in <code>x</code> that contains species names.</p></dd>

  <dt>abundanceColumn</dt>
<dd><p>The name of the column in <code>x</code> that contains abundance values.</p></dd>

  <dt>size1Column</dt>
<dd><p>The name of the column in <code>x</code> that contains values for primary size classes.</p></dd>

  <dt>size2Column</dt>
<dd><p>The name of the column in <code>x</code> that contains values for secondary size classes.</p></dd>

  <dt>cumulative</dt>
<dd><p>A flag to indicate that cumulative abundance profiles or surfaces are desired.</p></dd>

  <dt>counts</dt>
<dd><p>A flag to indicate that the output should be individual counts instead of added abundance values.</p></dd>

  <dt>mergeSpecies</dt>
<dd><p>A flag to indicate that species identity should be ignored. This leads to analyzing the structure of biomass disregarding species identity.</p></dd>

  <dt>verbose</dt>
<dd><p>A logical flag to indicate extra output.</p></dd>

  <dt>X</dt>
<dd><p>A list with as many elements as plot records. Each element should be of class 'matrix' or 'data.frame' with species in rows and strata in columns. Furthermore, the number of rows (species) and columns (strata) should be the same for all elements.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>For each individual (row) in <code>x</code>, <code>stratifyvegdata</code> assigns it to the size class (stratum) containing its size. The corresponding abundance value (e.g. crown cover) of the individual is added to the abundance of the corresponding species at the size class (stratum). If <code>sizes2</code> and <code>size2Column</code> are supplied, the function assigns each individual (row) in <code>x</code> to the combination of size classes (e.g. tree height and diameter).</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    

<p>Both functions return an object of class '<code>stratifiedvegdata</code>', which is a list of matrices, one for each plot record. Each element (matrix) has as many rows as species and as many columns as size classes (i.e., as many as elements in vector <code>sizes1</code>). Columns are named starting with 'S' and continuing with the size class (stratum) number. If <code>mergeSpecies=TRUE</code> then all matrices have a single row (whose name is <code>"all"</code>). If <code>sizes2</code> and <code>size2Column</code> are supplied to <code>stratifyvegdata</code>, the function returns an object of class '<code>doublestratifiedvegdata</code>', which is a list of arrays, one for each plot record. Each element (array) has three dimensions corresponding to species, primary sizes (number of elements in in vector <code>sizes1</code>) and secondary sizes (number of elements in in vector <code>sizes2</code>). If <code>cumulative=TRUE</code> then the function returns cumulative abundances (see <code><a href="CAP.html">CAP</a></code> and <code><a href="CAS.html">CAS</a></code>).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>De Cáceres, M., Legendre, P. &amp; He, F. (2013) Dissimilarity measurements and the size structure of ecological communities. Methods in Ecology and Evolution 4: 1167-1177.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Miquel De Cáceres, Forest Science Center of Catalonia.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/reshape.html" class="external-link">reshape</a></code>, <code><a href="CAP.html">CAP</a></code>, <code><a href="CAS.html">CAS</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Load tree data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">treedata</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Inspect tree data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">treedata</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   plotID species height cover      diam</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      1       H      4   0.2 1.1328793</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      1       H      4   0.2 1.1630979</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      1       H      4   0.2 1.0639817</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      2       H      4   0.2 1.0959077</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      2       O      1   0.2 0.7445254</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      2       H      4   0.2 1.1514505</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Define stratum thresholds (4 strata)</span></span></span>
<span class="r-in"><span><span class="va">heights</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">4</span>, by<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">diameters</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span>, by<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Stratify tree data using heights as structural variable</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">=</span> <span class="fu">stratifyvegdata</span><span class="op">(</span><span class="va">treedata</span>, sizes1<span class="op">=</span><span class="va">heights</span>, plotColumn<span class="op">=</span><span class="st">"plotID"</span>,</span></span>
<span class="r-in"><span>                    speciesColumn<span class="op">=</span><span class="st">"species"</span>, size1Column<span class="op">=</span><span class="st">"height"</span>, counts<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Inspect the second plot record</span></span></span>
<span class="r-in"><span><span class="va">X</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [0,0.5] (0.5,1] (1,1.5] (1.5,2] (2,2.5] (2.5,3] (3,3.5] (3.5,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> H       0       0       0       0       0       0       0       3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> N       0       0       0       0       0       0       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> O       0       2       0       0       0       0       0       0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Stratify tree data using heights as structural variable and cover as abundance</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">=</span> <span class="fu">stratifyvegdata</span><span class="op">(</span><span class="va">treedata</span>, sizes1<span class="op">=</span><span class="va">heights</span>, plotColumn<span class="op">=</span><span class="st">"plotID"</span>,</span></span>
<span class="r-in"><span>                    speciesColumn<span class="op">=</span><span class="st">"species"</span>, size1Column<span class="op">=</span><span class="st">"height"</span>, </span></span>
<span class="r-in"><span>                    abundanceColumn<span class="op">=</span><span class="st">"cover"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Y</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [0,0.5] (0.5,1] (1,1.5] (1.5,2] (2,2.5] (2.5,3] (3,3.5] (3.5,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> H       0     0.0       0       0       0       0       0     0.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> N       0     0.0       0       0       0       0       0     0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> O       0     0.4       0       0       0       0       0     0.0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Stratify tree data using heights and diameters as structural variables</span></span></span>
<span class="r-in"><span><span class="va">Z</span> <span class="op">=</span> <span class="fu">stratifyvegdata</span><span class="op">(</span><span class="va">treedata</span>, sizes1<span class="op">=</span><span class="va">heights</span>, sizes2<span class="op">=</span><span class="va">diameters</span>, plotColumn<span class="op">=</span><span class="st">"plotID"</span>,</span></span>
<span class="r-in"><span>                    speciesColumn<span class="op">=</span><span class="st">"species"</span>, size1Column<span class="op">=</span><span class="st">"height"</span>, size2Column<span class="op">=</span><span class="st">"diam"</span>,</span></span>
<span class="r-in"><span>                    counts<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Z</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , [0,0.5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [0,0.5] (0.5,1] (1,1.5] (1.5,2] (2,2.5] (2.5,3] (3,3.5] (3.5,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> H       0       0       0       0       0       0       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> N       0       0       0       0       0       0       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> O       0       0       0       0       0       0       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , (0.5,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [0,0.5] (0.5,1] (1,1.5] (1.5,2] (2,2.5] (2.5,3] (3,3.5] (3.5,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> H       0       0       0       0       0       0       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> N       0       0       0       0       0       0       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> O       0       2       0       0       0       0       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , (1,1.5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [0,0.5] (0.5,1] (1,1.5] (1.5,2] (2,2.5] (2.5,3] (3,3.5] (3.5,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> H       0       0       0       0       0       0       0       3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> N       0       0       0       0       0       0       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> O       0       0       0       0       0       0       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , (1.5,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [0,0.5] (0.5,1] (1,1.5] (1.5,2] (2,2.5] (2.5,3] (3,3.5] (3.5,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> H       0       0       0       0       0       0       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> N       0       0       0       0       0       0       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> O       0       0       0       0       0       0       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Miquel De Cáceres.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

