<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Cumulative abundance profile (CAP) — CAP • vegclust</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Cumulative abundance profile (CAP) — CAP"><meta property="og:description" content="Functions to calculate cumulative abundance profiles (CAPs), to build matrices from them, and to summarize several profiles."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vegclust</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/MedRegExample.html">Describing vegetation in terms of structure and composition</a>
    </li>
    <li>
      <a href="../articles/VegetationClassification.html">How to use the vegclust package</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Cumulative abundance profile (CAP)</h1>
    
    <div class="hidden name"><code>CAP.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Functions to calculate cumulative abundance profiles (CAPs), to build matrices from them, and to summarize several profiles.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">CAP</span><span class="op">(</span><span class="va">x</span>, transform<span class="op">=</span><span class="cn">NULL</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">CAP2matrix</span><span class="op">(</span><span class="va">CAP</span>, type<span class="op">=</span><span class="st">"cumulative"</span>,classWeights<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="fu">CAPcenters</span><span class="op">(</span><span class="va">CAP</span>, y<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="fu">CAPquantile</span><span class="op">(</span><span class="va">CAP</span>, q <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>A stratified vegetation data set (see function <code><a href="stratifyvegdata.html">stratifyvegdata</a></code>).</p></dd>

  <dt>transform</dt>
<dd><p>A function or the name of a function to be applied to each cumulative abundance value.</p></dd>

  <dt>verbose</dt>
<dd><p>A logical flag to indicate extra output.</p></dd>

  <dt>CAP</dt>
<dd><p>An object of class '<code>CAP</code>'.</p></dd>

  <dt>type</dt>
<dd><p>The type of information that the resulting matrix should contain. Either <code>"profile"</code>, <code>"abundance"</code> or <code>"volume"</code>.</p></dd>

  <dt>classWeights</dt>
<dd><p>A numerical vector containing the weight for size class. If <code>NULL</code>, then all classes are assumed to have the same weight.</p></dd>

  <dt>y</dt>
<dd><p>A vector used as a factor to calculate average or quantile profiles per each level. Alternatively, an object of class <code><a href="vegclust.html">vegclust</a></code> for which CAP centroids or medoids are desired.</p></dd>

  <dt>q</dt>
<dd><p>Probability value for which the quantile is desired. By default the median is given.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Function <code>CAP</code> replaces the abundance value of a size class by the sum of abundances in this and larger size classes (strata). Thus, upper classes contain smaller abundance values than lower classes, creating a cumulative abundance profile. Function <code>CAP2matrix</code> takes an object of class '<code>CAP</code>' and returns a data matrix, where values differ depending on parameter <code>type</code>: (1) <code>type="cumulative"</code> simply reshapes the '<code>CAP</code>' object (a list) into a matrix with as many rows as plot records and where columns are organized in blocks (there are as many blocks as species and each block has as many columns as size classes); (2) <code>type="total"</code> returns a plot-by-species matrix where each value is the total abundance of the species in the plot (i.e. the CAP value at the ground level); (3) <code>type="volume"</code> returns a plot-by-species matrix where each value is the sum of CAP values across size classes (a measure of the "volume" occupied by the species in the plot). When provided, <code>classWeights</code> are used to weight size classes of the cumulative abundance profiles (for (1) and (3) only). Function <code>CAPcenters</code> calculates the average abundance profile for a set of plot records. If <code>y</code> is a factor, it is used to speficy groups of samples for which average profiles are to be calculated. If <code>y</code> is an object of class '<code><a href="vegclust.html">vegclust</a></code>' then the function returns the CAP centroids or medoids corresponding to the clustering result. Function <code>CAPquantile</code> calculates a quantile profile for a set of CAPs. The usage of <code>y</code> is the same as for <code>CAPcenters</code>.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    

<p>Function <code>CAP</code> returns an object of class '<code>CAP</code>', similar to objects of class '<code>stratifiedvegdata</code>' but where abundance values of upper size classes have beed added to those of lower size classes. Function <code>CAP2matrix</code> returns a matrix with species as rows (columns depend on the value of <code>type</code>). Functions <code>CAPcenters</code> and <code>CAPquantile</code> return an object of class '<code>CAP</code>'.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>De Cáceres, M., Legendre, P. &amp; He, F. (2013) Dissimilarity measurements and the size structure of ecological communities. Methods in Ecology and Evolution 4: 1167-1177.</p>
<p>De Cáceres, M., Coll, L., Martín-Alcón, S., González-Olabarria, J.R. (submitted) A general method for the classification of forest stands using structure and composition.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Miquel De Cáceres, Forest Science Center of Catalonia.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="stratifyvegdata.html">stratifyvegdata</a></code>, <code><a href="plot.CAP.html">plot.CAP</a></code>, <code><a href="vegdiststruct.html">vegdiststruct</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Load stratified data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">medreg</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Check that 'medreg' has correct class</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">medreg</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "stratifiedvegdata" "list"             </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Look at the data for the third plot</span></span></span>
<span class="r-in"><span><span class="va">medreg</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                1    2    3    4    5 6 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pine trees                   0.0 12.5  0.0  0.0  0.0 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Quercus trees                0.0  0.0 12.5 12.5 12.5 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tall shrubs and small trees  0.0 25.0 62.5 25.0  0.0 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Scrubs and small shrubs      0.0 50.0  0.0  0.0  0.0 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Grass                       37.5  0.0  0.0  0.0  0.0 0 0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create cumulative abundance profile (CAP) for each plot</span></span></span>
<span class="r-in"><span><span class="va">medreg.CAP</span> <span class="op">=</span> <span class="fu">CAP</span><span class="op">(</span><span class="va">medreg</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Look at the profile of the third plot</span></span></span>
<span class="r-in"><span><span class="va">medreg.CAP</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                 1     2    3  4    5 6 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pine trees                   12.5  12.5  0.0  0  0.0 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Quercus trees                37.5  37.5 37.5 25 12.5 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tall shrubs and small trees 112.5 112.5 87.5 25  0.0 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Scrubs and small shrubs      50.0  50.0  0.0  0  0.0 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Grass                        37.5   0.0  0.0  0  0.0 0 0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create matrix with species abundances</span></span></span>
<span class="r-in"><span><span class="va">medreg.X</span> <span class="op">=</span> <span class="fu">CAP2matrix</span><span class="op">(</span><span class="va">medreg.CAP</span>, type<span class="op">=</span><span class="st">"total"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">medreg.X</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Pine trees Quercus trees Tall shrubs and small trees Scrubs and small shrubs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        0.0          37.5                        87.5                    50.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2        0.0           0.0                        87.5                    25.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       12.5          37.5                       112.5                    50.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       12.5          25.0                        62.5                    37.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5        0.0          25.0                        75.0                    25.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6       12.5          37.5                        87.5                    37.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Grass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  50.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  12.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  37.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  50.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  37.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  50.0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Generate and plot average profile</span></span></span>
<span class="r-in"><span><span class="va">average.CAP</span> <span class="op">=</span> <span class="fu">CAPcenters</span><span class="op">(</span><span class="va">medreg.CAP</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">average.CAP</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="CAP-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Generate and plot median profile</span></span></span>
<span class="r-in"><span><span class="va">median.CAP</span> <span class="op">=</span> <span class="fu">CAPquantile</span><span class="op">(</span><span class="va">medreg.CAP</span>, q <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">median.CAP</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="CAP-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Miquel De Cáceres.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

